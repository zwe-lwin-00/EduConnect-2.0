<div class="page-block">
  <dx-button [text]="'← ' + (studentName || 'Student')" type="normal" stylingMode="text" (onClick)="navigateBack()" class="back-btn"></dx-button>
  <dx-toast [visible]="!!error" type="error" [message]="error" [displayTime]="6000" (onHidden)="error = ''" [position]="{ at: { x: 'center', y: 'top' }, my: { x: 'center', y: 'top' } }"></dx-toast>
  <dx-load-panel [visible]="loading" [showIndicator]="true" [showPane]="true" [shading]="false" message="Loading…"></dx-load-panel>
  <div *ngIf="!loading && invalidStudent" class="invalid-student">
    <p>Invalid student.</p>
    <dx-button text="Return to My students" type="normal" (onClick)="navigateToParent()"></dx-button>
  </div>
  <div *ngIf="!loading && !error && !invalidStudent">
    <header class="page-header">
      <h1>Calendar{{ studentName ? ': ' + studentName : '' }}</h1>
      <div class="month-nav">
        <dx-button text="← Prev" type="normal" stylingMode="outlined" (onClick)="prevMonth()"></dx-button>
        <span class="month-label">{{ monthLabel() }}</span>
        <dx-button text="Next →" type="normal" stylingMode="outlined" (onClick)="nextMonth()"></dx-button>
      </div>
    </header>
    <div class="calendar-wrap">
      <table class="month-grid">
        <thead>
          <tr>
            <th *ngFor="let w of weekDays" class="weekday">{{ w }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of weeks">
            <td *ngFor="let cell of row" class="day-cell" [class.other-month]="!cell.isCurrentMonth" [class.holiday]="cell.isHoliday">
              <div class="day-num">{{ cell.dayOfMonth }}</div>
              <div *ngIf="cell.isHoliday" class="holiday-label">Holiday</div>
              <ul class="day-items">
                <li *ngFor="let it of cell.items" [class.completed]="it.completed" [class.upcoming]="!it.completed">
                  <span class="type">{{ it.type === 'ONE_TO_ONE' ? '1:1' : 'Group' }}</span>
                  <span class="label">{{ it.label }}</span>
                  <span class="status">{{ it.completed ? '✓' : '—' }}</span>
                </li>
              </ul>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
