<div class="page-block">
  <header class="page-header">
    <h1>Teachers</h1>
    <dx-button text="Onboard teacher" type="default" (onClick)="openOnboard()"></dx-button>
  </header>
  <dx-toast [visible]="!!error" type="error" [message]="error" [displayTime]="6000" (onHidden)="error = ''" [position]="{ at: { x: 'center', y: 'top' }, my: { x: 'center', y: 'top' } }"></dx-toast>
  <dx-load-panel [visible]="loading" [showIndicator]="true" [showPane]="true" [shading]="false" message="Loadingâ€¦"></dx-load-panel>
  <div *ngIf="!loading && !error && !teachers.length" class="empty-state">
    <p>No teachers yet.</p>
    <dx-button text="Onboard teacher" type="default" (onClick)="openOnboard()"></dx-button>
  </div>
  <dx-data-grid
    *ngIf="!loading && !error && teachers.length"
    [dataSource]="teachers"
    [showBorders]="true"
    [columnAutoWidth]="true"
    keyExpr="id">
    <dxi-column dataField="fullName" caption="Name"></dxi-column>
    <dxi-column dataField="email" caption="Email"></dxi-column>
    <dxi-column dataField="verificationStatus" caption="Status"></dxi-column>
    <dxi-column dataField="active" caption="Active" dataType="boolean"></dxi-column>
    <dxi-column type="buttons" width="340" caption="Actions">
      <dxi-button hint="Edit" (onClick)="openEdit($any($event).row.data)"></dxi-button>
      <dxi-button hint="Reset password" (onClick)="openResetPassword($any($event).row.data)"></dxi-button>
      <dxi-button hint="Verify" (onClick)="verify($any($event).row.data)"></dxi-button>
      <dxi-button hint="Reject" (onClick)="reject($any($event).row.data)"></dxi-button>
      <dxi-button hint="Activate" (onClick)="activate($any($event).row.data)"></dxi-button>
      <dxi-button hint="Suspend" (onClick)="suspend($any($event).row.data)"></dxi-button>
    </dxi-column>
  </dx-data-grid>
</div>

<dx-popup
  [(visible)]="showOnboard"
  title="Onboard teacher"
  [showCloseButton]="true"
  [width]="480"
  (onHiding)="closeOnboard()">
  <div class="popup-form">
    <div class="form-item">
      <label>Email</label>
      <dx-text-box [(value)]="onboardForm.email" placeholder="email@example.com" mode="email"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Full name</label>
      <dx-text-box [(value)]="onboardForm.fullName"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Phone</label>
      <dx-text-box [(value)]="onboardForm.phone"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Education</label>
      <dx-text-box [(value)]="onboardForm.education"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Bio</label>
      <dx-text-area [(value)]="onboardForm.bio" [height]="80"></dx-text-area>
    </div>
    <div class="form-item">
      <label>Specializations (comma-separated)</label>
      <dx-text-box [(value)]="onboardForm.specializations" placeholder="e.g. Math, Science"></dx-text-box>
    </div>
    <div *ngIf="tempPassword" class="temp-password">
      <strong>Temporary password (share with teacher):</strong> {{ tempPassword }}
    </div>
    <div class="popup-actions">
      <dx-button text="Create" type="default" (onClick)="submitOnboard()"></dx-button>
      <dx-button [text]="tempPassword ? 'Close' : 'Cancel'" type="normal" (onClick)="closeOnboard()"></dx-button>
    </div>
  </div>
</dx-popup>

<dx-popup
  [(visible)]="showResetPassword"
  title="Reset password"
  [showCloseButton]="true"
  [width]="420"
  (onHiding)="closeResetPassword()">
  <div class="popup-form" *ngIf="resetTeacher">
    <p>Reset password for <strong>{{ resetTeacher.fullName }}</strong> ({{ resetTeacher.email }})? They will be required to change it on next login.</p>
    <div *ngIf="resetPasswordResult" class="temp-password">
      <strong>Share with teacher:</strong><br />
      Email: {{ resetPasswordResult.email }}<br />
      Temporary password: {{ resetPasswordResult.temporaryPassword }}
    </div>
    <div class="popup-actions">
      <dx-button *ngIf="!resetPasswordResult" text="Reset password" type="default" (onClick)="confirmResetPassword()"></dx-button>
      <dx-button [text]="resetPasswordResult ? 'Close' : 'Cancel'" type="normal" (onClick)="closeResetPassword()"></dx-button>
    </div>
  </div>
</dx-popup>

<dx-popup
  [(visible)]="showEdit"
  title="Edit teacher"
  [showCloseButton]="true"
  [width]="480"
  (onHiding)="closeEdit()">
  <div class="popup-form" *ngIf="selectedTeacher">
    <div class="form-item">
      <label>Full name</label>
      <dx-text-box [(value)]="editForm.fullName"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Phone</label>
      <dx-text-box [(value)]="editForm.phone"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Education</label>
      <dx-text-box [(value)]="editForm.education"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Bio</label>
      <dx-text-area [(value)]="editForm.bio" [height]="80"></dx-text-area>
    </div>
    <div class="form-item">
      <label>Specializations (comma-separated)</label>
      <dx-text-box [(value)]="editForm.specializations" placeholder="e.g. Math, Science"></dx-text-box>
    </div>
    <div class="popup-actions">
      <dx-button text="Save" type="default" (onClick)="saveEdit()"></dx-button>
      <dx-button text="Cancel" type="normal" (onClick)="closeEdit()"></dx-button>
    </div>
  </div>
</dx-popup>
