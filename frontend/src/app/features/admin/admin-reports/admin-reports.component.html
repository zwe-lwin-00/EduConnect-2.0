<div class="page-block">
  <header class="page-header">
    <h1>Daily and monthly reports</h1>
  </header>
  <p class="hint">Sessions = One-To-One attendance records in the period. Revenue = hours × teacher hourly rate (or default).</p>
  <dx-toast [visible]="!!error" type="error" [message]="error" [displayTime]="6000" (onHidden)="error = ''" [position]="{ at: { x: 'center', y: 'top' }, my: { x: 'center', y: 'top' } }"></dx-toast>
  <div class="toolbar">
    <label>From</label>
    <dx-date-box [value]="from" (valueChange)="from = $event; onRangeChange()" type="date"></dx-date-box>
    <label>To</label>
    <dx-date-box [value]="to" (valueChange)="to = $event; onRangeChange()" type="date"></dx-date-box>
  </div>
  <dx-load-panel [visible]="loading" [showIndicator]="true" [showPane]="true" [shading]="false" message="Loading…"></dx-load-panel>
  <div *ngIf="!loading && !error" class="summary">
    <span class="summary-item">Total sessions: <strong>{{ totalSessions }}</strong></span>
    <span class="summary-item">Total revenue: <strong>{{ totalRevenue | number:'1.2-2' }}</strong></span>
  </div>
  <h2 *ngIf="!loading && !error">Daily</h2>
  <dx-data-grid *ngIf="!loading && !error" [dataSource]="daily" [showBorders]="true" keyExpr="date">
    <dxi-column dataField="date" caption="Date" dataType="date"></dxi-column>
    <dxi-column dataField="sessionCount" caption="Sessions" dataType="number"></dxi-column>
    <dxi-column dataField="revenue" caption="Revenue" dataType="number" format="#0.00"></dxi-column>
  </dx-data-grid>
  <h2 *ngIf="!loading && !error">Monthly</h2>
  <dx-data-grid *ngIf="!loading && !error" [dataSource]="monthly" [showBorders]="true" keyExpr="date">
    <dxi-column dataField="monthLabel" caption="Month"></dxi-column>
    <dxi-column dataField="sessionCount" caption="Sessions" dataType="number"></dxi-column>
    <dxi-column dataField="revenue" caption="Revenue" dataType="number" format="#0.00"></dxi-column>
  </dx-data-grid>
</div>
