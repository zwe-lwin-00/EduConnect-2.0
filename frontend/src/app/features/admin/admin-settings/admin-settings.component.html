<div class="page-block">
  <header class="page-header">
    <h1>Settings</h1>
  </header>
  <section>
    <h2>Holidays</h2>
    <dx-toast [visible]="!!error" type="error" [message]="error" [displayTime]="6000" (onHidden)="error = ''" [position]="{ at: { x: 'center', y: 'top' }, my: { x: 'center', y: 'top' } }"></dx-toast>
    <div class="toolbar">
      <label>Year</label>
      <dx-number-box [(value)]="holidayYear" [min]="2000" [max]="2100" (onValueChanged)="onYearChange()"></dx-number-box>
      <dx-button text="Add holiday" type="default" (onClick)="openHolidayForm()"></dx-button>
    </div>
    <dx-load-panel [visible]="loading" [showIndicator]="true" [showPane]="true" [shading]="false" message="Loadingâ€¦"></dx-load-panel>
    <div *ngIf="!loading && !error && !holidays.length" class="empty-state">
      <p>No holidays for this year.</p>
    </div>
    <dx-data-grid *ngIf="!loading && !error && holidays.length" [dataSource]="holidays" [showBorders]="true" keyExpr="id">
      <dxi-column dataField="holidayDate" caption="Date" dataType="date"></dxi-column>
      <dxi-column dataField="name" caption="Name"></dxi-column>
      <dxi-column dataField="description" caption="Description"></dxi-column>
      <dxi-column type="buttons" width="80">
        <dxi-button hint="Delete" (onClick)="confirmDeleteHoliday($any($event).row.data)"></dxi-button>
      </dxi-column>
    </dx-data-grid>
  </section>
  <section>
    <h2>Key-value settings</h2>
    <dx-data-grid [dataSource]="settings" [showBorders]="true" keyExpr="id">
      <dxi-column dataField="keyName" caption="Key"></dxi-column>
      <dxi-column dataField="value" caption="Value"></dxi-column>
      <dxi-column dataField="description" caption="Description"></dxi-column>
    </dx-data-grid>
  </section>
</div>
<dx-popup [(visible)]="showHolidayForm" title="Add holiday" [showCloseButton]="true" [width]="420" (onHiding)="closeHolidayForm()">
  <div class="popup-form">
    <div class="form-item">
      <label>Date</label>
      <dx-date-box [value]="holidayForm.holidayDate" (valueChange)="holidayForm.holidayDate = $event" type="date"></dx-date-box>
    </div>
    <div class="form-item">
      <label>Name</label>
      <dx-text-box [(value)]="holidayForm.name"></dx-text-box>
    </div>
    <div class="form-item">
      <label>Description</label>
      <dx-text-box [(value)]="holidayForm.description"></dx-text-box>
    </div>
    <div class="popup-actions">
      <dx-button text="Add" type="default" (onClick)="submitHoliday()"></dx-button>
      <dx-button text="Cancel" type="normal" (onClick)="closeHolidayForm()"></dx-button>
    </div>
  </div>
</dx-popup>
<dx-popup [(visible)]="showDeleteConfirm" title="Delete holiday" [showCloseButton]="true" [width]="400" (onHiding)="showDeleteConfirm = false; holidayToDelete = null">
  <p>Delete this holiday?</p>
  <div class="popup-actions">
    <dx-button text="Yes, delete" type="danger" (onClick)="doDeleteHoliday()"></dx-button>
    <dx-button text="No" type="normal" (onClick)="showDeleteConfirm = false; holidayToDelete = null"></dx-button>
  </div>
</dx-popup>
