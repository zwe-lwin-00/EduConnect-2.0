<div class="admin-dashboard">
  <dx-load-panel
    [visible]="loading"
    [showIndicator]="true"
    [showPane]="true"
    [shading]="true"
    message="Loadingâ€¦"
    [position]="{ of: 'body' }">
  </dx-load-panel>
  <dx-toast
    [visible]="!!error"
    type="error"
    message="{{ error }}"
    [displayTime]="8000"
    (onHidden)="error = ''"
    [position]="{ at: { x: 'center', y: 'top' }, my: { x: 'center', y: 'top' } }">
  </dx-toast>
  <header class="page-header">
    <h1>Admin Dashboard</h1>
    <p>EduConnect Freelance School</p>
  </header>
  <div *ngIf="!loading && !error && data.pendingActions?.length" class="alerts">
    <strong>Pending actions:</strong>
    <ul>
      <li *ngFor="let a of data.pendingActions">{{ a }}</li>
    </ul>
  </div>
  <div *ngIf="!loading && !error" class="cards">
    <div class="card">
      <h3>Pending teacher verifications</h3>
      <p class="value">{{ data.pendingTeacherVerifications ?? 0 }}</p>
      <dx-button text="Teachers" type="normal" stylingMode="text" (onClick)="navigate('/admin/teachers')"></dx-button>
    </div>
    <div class="card">
      <h3>Today's sessions</h3>
      <p class="value">{{ data.todaySessionsCount ?? 0 }}</p>
      <dx-button text="Attendance" type="normal" stylingMode="text" (onClick)="navigate('/admin/attendance')"></dx-button>
    </div>
    <div class="card">
      <h3>Subscriptions expiring soon</h3>
      <p class="value">{{ data.subscriptionsExpiringSoon ?? 0 }}</p>
      <dx-button text="Payments" type="normal" stylingMode="text" (onClick)="navigate('/admin/payments')"></dx-button>
    </div>
    <div class="card">
      <h3>Contracts expiring soon</h3>
      <p class="value">{{ data.contractsExpiringSoon ?? 0 }}</p>
      <dx-button text="One-To-One" type="normal" stylingMode="text" (onClick)="navigate('/admin/contracts')"></dx-button>
    </div>
    <div class="card">
      <h3>Revenue this month</h3>
      <p class="value">{{ data.revenueThisMonth ?? 0 | number:'1.2-2' }}</p>
      <dx-button text="Reports" type="normal" stylingMode="text" (onClick)="navigate('/admin/reports')"></dx-button>
    </div>
  </div>
  <div *ngIf="!loading && !error && summaryData.length" class="dx-grid-wrap">
    <dx-data-grid
      [dataSource]="summaryData"
      [showBorders]="true"
      [columnAutoWidth]="true"
      height="180">
      <dxi-column dataField="metric" caption="Metric"></dxi-column>
      <dxi-column dataField="value" caption="Value" dataType="number"></dxi-column>
    </dx-data-grid>
  </div>
  <div *ngIf="!loading && !error && !summaryData.length && !data.pendingTeacherVerifications && !data.todaySessionsCount && !data.subscriptionsExpiringSoon && !data.contractsExpiringSoon && !data.revenueThisMonth" class="empty-state">
    <p>No dashboard data yet. Use the links below to get started.</p>
  </div>
  <nav class="quick-links" aria-label="Quick links">
    <dx-button text="Teachers" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/teachers')"></dx-button>
    <dx-button text="Parents" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/parents')"></dx-button>
    <dx-button text="Students" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/students')"></dx-button>
    <dx-button text="One-To-One" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/contracts')"></dx-button>
    <dx-button text="Group" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/group-classes')"></dx-button>
    <dx-button text="Attendance" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/attendance')"></dx-button>
    <dx-button text="Payments" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/payments')"></dx-button>
    <dx-button text="Reports" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/reports')"></dx-button>
    <dx-button text="Settings" type="normal" stylingMode="outlined" (onClick)="navigate('/admin/settings')"></dx-button>
  </nav>
</div>
